<%= render 'layouts/link' %>

<h1>Listing all posts</h1>

<table class = table>
  <tr>
    <th>Author</th>
    <th>Title</th>
    <th>Text</th>
  </tr>

  <% @posts.each do |post| %>
    <%= form_tag url: 'posts#show' do %>
      <tr>
        <td><%= post.user.email %></td>
        <td><%= post.title %></td>
        <td><%= post.text %></td>
        <td><%= link_to 'Show', post_path(post) %></td>
        <% if current_user.admin %>
        <td><%= link_to 'Edit', edit_post_path(post) %></td>
        <td><%= link_to 'Destroy', post_path(post),
                        method: :delete,
                        data: { confirm: 'Are you sure?' } %></td>
        <td>
          <% if post.moderation && post.user != current_user %>
              <label>
                <%= check_box_tag :moderation, checked = true, options = post.id %>
                <%= hidden_field_tag :moderation_hidden, options = post.id %>
                Moderation
          <% elsif post.user != current_user %>
              <%= check_box_tag :moderation, options = post.id %>
              Moderation
              </label>
          <% end %>
        </td>
        <% unless current_user == post.user %>
          <td>
            <%= submit_tag %>
          </td>
        <% end %>
      </tr>
    <% end %>
  <% end %>
<% end %>

</table>

<!--<%= will_paginate @posts %>-->

<div class="apple_pagination">
  <div class="page_info">
    <%= page_entries_info @posts %>
  </div>
  <%= will_paginate @posts, :container => false %>
</div>